{-include file="header2.html"-}
<link rel="stylesheet" type="text/css" href="{-$style_url-}css/star.css?r={-$REVISION-}" /> 
<!--main-->
<div class="main">
<div class="container">  
<div class="row">
<div class="col-md-6"> 
	<div class="panel panel-default">
	   <div class="panel-heading">
		 {-$res_school.0.school_name-}<a href='{-rewrite url="?module=comment&action=index&id=$catid&sid=$sid"-}'>(98977条评论)</a>
	   </div>
	   <!--panel-->
			<div class="panel">
			<div class="panel-body">
			{-if $res_school-}
			{-foreach from=$res_school item=school-}
			{-assign var=schoolid value=$school.school_id-}
			<div class="progroup">
			  <div class="progress" >
			  <div class="progress-bar progress-bar-info" role="progressbar" style="width:{-$school.score-}%">
				<span>{-$school.satisfy_name-}<a href='{-rewrite url="?module=vote&action=index&id=$catid&pid=$schoolid"-}'>({-$school.membernum-}人投票)</a></span>
			  </div>
			  </div>
			</div>
			{-/foreach-}
			{-/if-}
		
			</div>
			</div>
		<!--panel end-->
	</div>
</div>
<div class="col-md-6"> 
	<div class="panel panel-default">
	   <div class="panel-heading">
		  {-$res_school.0.school_name-}
	   </div>
	   <div class="panel-body">
		 <ul  class="list-group">
		{-if $res_school-}
		{-foreach from=$res_school item=school-}
		{-assign var=satisfy_id value=$school.satisfy_id-}
		<li id="star{-$satisfy_id-}" satisfy="{-$satisfy_id-}" class="list-group-item star">
			<strong>{-$school.satisfy_name-}</strong>
			<div>
			<input name="1" type="button" class="inputstar"/>
			<input name="2" type="button" class="inputstar"/>
			<input name="3" type="button" class="inputstar"/>
			<input name="4" type="button" class="inputstar"/>
			<input name="5" type="button" class="inputstar"/>
			<input name="6" type="button" class="inputstar"/>
			<input name="7" type="button" class="inputstar"/>
			<input name="8" type="button" class="inputstar"/>
			<input name="9" type="button" class="inputstar"/>
			<input name="10" type="button" class="inputstar"/>
			<span id="starValue{-$satisfy_id-}">
			<b><font size="5" color="#fd7d28">0</font></b>分
			</span>
			</div>
		</li>
		{-/foreach-}
		{-/if-}
			
		</ul>
	   </div>
	</div>
</div>	
</div>
</div>
</div>

{-include file="footer.html"-}
<script>
$(".inputstar").mouseover(function(){
		//我的评分
		var inputstar=$(this).parents('li').attr('id');
		var starval=$(this).nextAll('span').attr('id');
		var GradList = document.getElementById(inputstar).getElementsByTagName("input");	
		
		//移入展示
		clear(GradList);
		for(var Qi=0;Qi<this.name;Qi++){
			GradList[Qi].style.backgroundPosition = 'left center';
			
		}		
		
		star(GradList);
	})

	
	function star(GradList){
		for(var i=0;i < GradList.length;i++){
			 temp = 0;
			GradList[i].onclick = function(){
				temp = this.name;
				var starval=$(this).nextAll('span').attr('id');
				var school_id="{-$sid-}";
				var school_satisfy=$(this).parents('li').attr('satisfy');
				var school_score=temp;
				
				//评分
				$.ajax({ 
					cache:"false",
					url: root_url+"index.php?module=ajax&action=star",
					type: "get", 
					data:"memberid="+memberid+"&school_id="+school_id+"&school_satisfy="+school_satisfy+"&school_score="+school_score,
					success: function(data){
						data = $.parseJSON( data );
						if(data.flag==1){
							document.getElementById(starval).innerHTML = '<b><font size="5" color="#fd7d28">'+temp+'</font></b>分(评分成功)';
							current(temp);
						}else{
							document.getElementById(starval).innerHTML = '<b><font size="5" color="#fd7d28">评分失败</font></b>';
						}
					}
				}); 
				//评分END
			}
			
			//移出star
			GradList[i].onmouseout = function(){
				for(var Qi=0;Qi<this.name;Qi++){
					GradList[Qi].style.backgroundPosition = 'right center';
				}
				var starval=$(this).nextAll('span').attr('id');
				var temp=document.getElementById(starval).getElementsByTagName("font")[0].innerHTML;
				current(temp);
			}
		}

		//显示当前第几颗星
		function current(temp){
			clear(GradList);
		   for(var Qii=0;Qii<temp;Qii++){
			 GradList[Qii].style.backgroundPosition = 'left center';
		   }
		}	
		
	}
	
	//清除所有
	function clear(GradList){
		for(var Qi=0;Qi<GradList.length;Qi++){
		  GradList[Qi].style.backgroundPosition = 'right center';
		}
	}



</script>

</html>